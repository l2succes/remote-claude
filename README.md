â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•
â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â• â•šâ•â•â•â•â•â•    â•šâ•â•   â•šâ•â•â•â•â•â•â•

 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•
â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•
â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
 â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•

# Remote Claude - Run Claude Agent SDK Anywhere

> **Run Claude Agent SDK remotely on GitHub Codespaces, AWS EC2, or Azure Container Instances with full task management, WebSocket communication, and MCP support**

[![npm version](https://badge.fury.io/js/remote-claude.svg)](https://badge.fury.io/js/remote-claude)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js Version](https://img.shields.io/badge/node-%3E%3D18.0.0-brightgreen)](https://nodejs.org/)

## ğŸ—ï¸ System Architecture

Remote Claude is a distributed system that allows you to run the Claude Agent SDK remotely in cloud environments. Here's how it works:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         WebSocket          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                  â”‚
â”‚   CLI Client    â”‚                            â”‚  Agent Server    â”‚
â”‚   (rclaude)     â”‚         Commands &         â”‚  (Container)     â”‚
â”‚                 â”‚         Responses          â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                               â”‚
        â”‚                                               â”‚
        â–¼                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Local Machine  â”‚                            â”‚ Claude Agent SDK â”‚
â”‚  - Config files â”‚                            â”‚  - Tool executionâ”‚
â”‚  - Task storage â”‚                            â”‚  - MCP servers   â”‚
â”‚  - SSH keys     â”‚                            â”‚  - File access   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
                                                        â–¼
                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                               â”‚ Cloud Provider   â”‚
                                               â”‚ - GitHub Spaces  â”‚
                                               â”‚ - AWS EC2        â”‚
                                               â”‚ - Azure ACI      â”‚
                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Components

1. **CLI Client (`apps/cli`)** - Command-line interface for users
2. **Agent Server (`services/agent-server`)** - WebSocket server wrapping Claude Agent SDK
3. **Core Library (`packages/core`)** - Provider abstractions and task management
4. **Shared Protocol (`packages/shared`)** - WebSocket protocol definitions
5. **Web Interface (`apps/web`)** - Optional web UI for monitoring

## ğŸš€ Quick Start

```bash
# Install globally
npm install -g remote-claude

# Initialize project
rclaude init

# Connect to a running agent server
rclaude connect ws://localhost:8080

# Run a query
rclaude query "Help me understand this codebase"
```

## ğŸ¯ How Claude Agent SDK is Integrated

The Claude Agent SDK is wrapped by our **Agent Server** service, which:

### 1. **Agent Server (`services/agent-server/src/executor.ts`)**

The `AgentExecutor` class wraps the Claude Agent SDK:

```typescript
// Dynamic import of the SDK
const sdk = await import('@anthropic-ai/claude-agent-sdk');

// Configure SDK with options
const client = new ClaudeSDKClient({
  systemPrompt: config.systemPrompt,
  maxTurns: config.maxTurns || 50,
  allowedTools: ['Read', 'Write', 'Bash', 'WebSearch'],
  permissionMode: 'acceptEdits',
  cwd: config.workingDirectory,
  mcpServers: config.mcpServers
});

// Execute queries and stream responses
await client.query(prompt);
for await (const message of client.receiveResponse()) {
  // Process and forward via WebSocket
}
```

### 2. **WebSocket Protocol (`packages/shared/src/protocol.ts`)**

Communication between CLI and Agent Server uses a structured protocol:

- **Query Messages** - Send prompts to Claude
- **Response Messages** - Stream Claude's responses
- **Tool Use/Result** - Real-time tool execution updates
- **Progress Messages** - Status updates during execution
- **Error Handling** - Graceful error recovery

### 3. **Container Deployment (`container/Dockerfile`)**

The Agent Server runs in containers with:

- Node.js 20 runtime
- Claude Agent SDK dependencies
- MCP server configurations
- Workspace volume mounting
- Health checks and monitoring

## ğŸ“¦ Monorepo Structure (Bun Workspaces)

```
.
â”œâ”€â”€ apps/                    # Applications
â”‚   â”œâ”€â”€ cli/                # Command-line interface
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts    # CLI entry point
â”‚   â”‚   â”‚   â””â”€â”€ commands/   # CLI commands
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ web/                # Next.js web interface
â”‚   â”‚   â”œâ”€â”€ app/           # App router pages
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ api/               # REST API (optional)
â”‚
â”œâ”€â”€ packages/              # Shared packages
â”‚   â”œâ”€â”€ core/             # Core business logic
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ providers/    # Cloud provider integrations
â”‚   â”‚   â”‚   â”œâ”€â”€ tasks/        # Task management
â”‚   â”‚   â”‚   â””â”€â”€ types/        # TypeScript types
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â”œâ”€â”€ shared/           # Shared protocol & types
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ protocol.ts   # WebSocket protocol
â”‚   â”‚   â”‚   â””â”€â”€ types.ts      # Shared types
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ ui/               # UI components & utilities
â”‚
â”œâ”€â”€ services/             # Microservices
â”‚   â”œâ”€â”€ agent-server/     # Claude Agent SDK server
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts      # WebSocket server
â”‚   â”‚   â”‚   â”œâ”€â”€ executor.ts   # SDK wrapper
â”‚   â”‚   â”‚   â””â”€â”€ mcp-manager.ts # MCP integration
â”‚   â”‚   â””â”€â”€ package.json
â”‚   â””â”€â”€ notifications/    # Notification service
â”‚
â”œâ”€â”€ container/           # Docker configurations
â”‚   â”œâ”€â”€ Dockerfile      # Production container
â”‚   â”œâ”€â”€ Dockerfile.dev  # Development container
â”‚   â””â”€â”€ mcps/          # MCP server configs
â”‚
â”œâ”€â”€ docs/              # Documentation
â”œâ”€â”€ scripts/           # Build & utility scripts
â”œâ”€â”€ package.json       # Root package.json (bun workspaces)
â”œâ”€â”€ bun.lock          # Bun lockfile
â””â”€â”€ docker-compose.yml # Local development setup
```

## ğŸ”§ Development Setup

### Prerequisites

- **Bun** (v1.0+) - Fast JavaScript runtime and package manager
- **Node.js** (v18+) - For running the services
- **Docker** - For containerized development
- **Anthropic API Key** - For Claude Agent SDK

### Local Development

```bash
# Clone the repository
git clone https://github.com/yourusername/remote-claude.git
cd remote-claude

# Install dependencies with bun
bun install

# Copy environment variables
cp .env.example .env
# Edit .env and add your ANTHROPIC_API_KEY

# Run development servers (all packages)
bun run dev

# Or run specific services
bun run --filter @remote-claude/agent-server dev
bun run --filter @remote-claude/cli dev
bun run --filter website dev
```

### Docker Development

```bash
# Start the agent server
docker-compose up -d

# View logs
docker-compose logs -f agent

# Connect CLI to local server
rclaude connect ws://localhost:8080
```

## ğŸŒ Cloud Deployment

### GitHub Codespaces

The system can deploy an agent server to a GitHub Codespace:

1. CLI creates a new Codespace via GitHub API
2. Codespace runs the agent-server container
3. CLI connects via WebSocket to the Codespace URL
4. Tasks execute in the cloud environment

### AWS EC2

For EC2 deployments:

1. CLI provisions an EC2 instance with user data script
2. Instance installs Docker and runs agent-server
3. CLI establishes SSH tunnel for WebSocket connection
4. Auto-terminates after task completion

### Azure Container Instances

For serverless container execution:

1. CLI creates an ACI with the agent-server image
2. Container runs with public IP and WebSocket port
3. CLI connects directly to the container
4. Auto-deletes after task completion

## ğŸ”Œ MCP (Model Context Protocol) Support

The Agent Server supports MCP servers for extended capabilities:

```javascript
// Configure MCP servers
const mcpServers = {
  "filesystem": {
    "command": "mcp-server-filesystem",
    "args": ["--root", "/workspace"]
  },
  "git": {
    "command": "mcp-server-git",
    "args": ["--repo", "."]
  }
};

// Pass to executor
new AgentExecutor({
  mcpServers: mcpServers,
  // ... other options
});
```

## ğŸ“¡ WebSocket Protocol

The CLI and Agent Server communicate using a structured WebSocket protocol:

### Message Types

**Client â†’ Server:**
- `query` - Execute a Claude query
- `cancel` - Cancel running task
- `configure` - Update configuration
- `ping` - Keep connection alive

**Server â†’ Client:**
- `response` - Claude's response chunks
- `tool_use` - Tool execution started
- `tool_result` - Tool execution completed
- `progress` - Status updates
- `error` - Error messages
- `complete` - Task completion

### Example Flow

```javascript
// Client sends query
{
  "type": "query",
  "payload": {
    "prompt": "Help me debug this code",
    "sessionId": "uuid",
    "options": {
      "maxTurns": 10,
      "allowedTools": ["Read", "Write"]
    }
  }
}

// Server streams responses
{
  "type": "response",
  "payload": {
    "content": [
      { "type": "text", "text": "I'll help you debug..." }
    ],
    "turn": 1,
    "done": false
  }
}

// Tool execution
{
  "type": "tool_use",
  "payload": {
    "toolId": "tool_123",
    "toolName": "Read",
    "input": { "file": "main.js" }
  }
}

// Completion
{
  "type": "complete",
  "payload": {
    "status": "success",
    "totalTurns": 3,
    "tokensUsed": 1500
  }
}
```

## ğŸ”§ Available Tools

The Claude Agent SDK can use these tools:

- **Read** - Read files from the workspace
- **Write** - Write/create files
- **Bash** - Execute shell commands
- **WebSearch** - Search the web
- **WebFetch** - Fetch web content
- **Edit** - Edit existing files
- **TodoWrite** - Manage task lists

## ğŸš€ CLI Commands

### Connection Management

```bash
# Connect to agent server
rclaude connect ws://localhost:8080

# Connect with custom options
rclaude connect ws://remote-server:8080 \
  --api-key $ANTHROPIC_API_KEY \
  --working-dir /custom/path
```

### Query Execution

```bash
# Send a query
rclaude query "Explain the architecture of this project"

# Query with options
rclaude query "Fix the authentication bug" \
  --max-turns 20 \
  --tools Read,Write,Bash \
  --timeout 300
```

### Task Management

```bash
# Create and run a task
rclaude run fix-auth-bug

# List tasks
rclaude tasks

# Show task details
rclaude tasks show fix-auth-bug
```

## ğŸ“š Key Features

### 1. **Distributed Architecture**
- CLI runs locally, Agent SDK runs remotely
- WebSocket for real-time communication
- Automatic reconnection and error recovery

### 2. **Multi-Cloud Support**
- GitHub Codespaces integration
- AWS EC2 with spot instances
- Azure Container Instances
- Local Docker development

### 3. **Task Management**
- Save and reuse task configurations
- Track task history and results
- Parallel task execution

### 4. **Real-time Streaming**
- Stream Claude's responses as they generate
- Live tool execution updates
- Progress indicators for long operations

### 5. **MCP Integration**
- Extend capabilities with MCP servers
- Custom tool implementations
- Third-party integrations

### 6. **Security**
- API keys never stored in containers
- Secure WebSocket connections
- Automatic resource cleanup

## ğŸ› ï¸ Building & Testing

```bash
# Build all packages
bun run build

# Run tests
bun run test

# Lint code
bun run lint

# Clean build artifacts
bun run clean

# Build specific package
bun run --filter @remote-claude/core build
```

## ğŸ” Debugging

### Enable Debug Logging

```bash
# Set log level
export LOG_LEVEL=debug

# Run with debug output
rclaude query "test" --debug
```

### Check Agent Server Health

```bash
# Health endpoint
curl http://localhost:8080/health

# List active sessions
curl http://localhost:8080/sessions
```

### View Container Logs

```bash
# Docker logs
docker logs remote-claude-agent

# Docker Compose logs
docker-compose logs -f agent
```

## ğŸ¤ Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details.

### Development Workflow

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Run tests and linting
5. Submit a pull request

### Code Style

- TypeScript for all code
- ESLint for linting
- Prettier for formatting
- Conventional commits

## ğŸ“„ License

MIT License - see [LICENSE](LICENSE) for details.

## ğŸ™ Acknowledgments

- Built with [Claude Agent SDK](https://github.com/anthropics/claude-agent-sdk)
- Powered by [Bun](https://bun.sh) for fast development
- WebSocket protocol inspired by best practices
- MCP integration for extensibility

## ğŸ”— Links

- [Documentation](./docs)
- [API Reference](./docs/api.md)
- [WebSocket Protocol](./docs/protocol.md)
- [Provider Setup](./docs/providers.md)
- [MCP Configuration](./docs/mcp.md)

---

<div align="center">
  <strong>Remote Claude - Distributed AI Development with Claude Agent SDK â˜ï¸</strong>
  <br>
  <sub>Run Claude anywhere, build anything</sub>
</div>